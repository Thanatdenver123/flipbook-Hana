<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hana Photos</title>
    <script src="https://cdn.jsdelivr.net/npm/page-flip/dist/js/page-flip.browser.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: 'Sarabun', sans-serif;
            overflow: hidden;
        }

        /* ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏´‡∏•‡∏±‡∏Å (Background) */
        #main-container {
            width: 100%;
            height: 100vh;
            background-color: #333; /* ‡∏™‡∏µ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô */
            background-size: cover;
            background-position: center;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background 0.3s;
            position: relative;
        }

        /* ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πà‡∏°‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ */
        .flip-book {
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏µ‡∏£‡∏π‡∏õ */
        }

        .page {
            padding: 0;
            background-color: #fdfaf7;
            border: 1px solid #c2b5a3;
            overflow: hidden;
        }

        .page img {
            width: 100%;
            height: 100%;
            object-fit: contain; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡∏£‡∏≠‡∏ö */
        }

        .page-content {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            color: #888;
        }

        /* ‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° (Control Panel) */
        #controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            display: flex;
            gap: 15px;
            z-index: 100;
            flex-wrap: wrap;
            justify-content: center;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        label {
            font-size: 12px;
            margin-bottom: 5px;
            font-weight: bold;
        }

        input[type="file"] {
            display: none;
        }

        .btn {
            background-color: #007bff;
            color: white;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            border: none;
            transition: 0.2s;
        }

        .btn:hover {
            background-color: #0056b3;
        }

        .btn-secondary {
            background-color: #6c757d;
        }

        input[type="color"] {
            cursor: pointer;
            border: none;
            width: 50px;
            height: 35px;
        }

        #loading {
            position: absolute;
            color: white;
            font-size: 24px;
            display: none;
        }

    </style>
</head>
<body>

    <div id="main-container">
        
        <div id="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠...</div>

        <div id="book-wrapper">
            </div>

        <div id="controls">
            
            <div class="control-group">
                <label>1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏π‡∏õ)</label>
                <label for="bookUpload" class="btn">üìÇ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</label>
                <input type="file" id="bookUpload" multiple accept="image/*">
            </div>

            <div style="border-left: 1px solid #ccc; margin: 0 10px;"></div>

            <div class="control-group">
                <label>2. ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á (‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û)</label>
                <label for="bgUpload" class="btn btn-secondary">üñºÔ∏è ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î BG</label>
                <input type="file" id="bgUpload" accept="image/*">
            </div>

            <div class="control-group">
                <label>3. ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á (‡∏™‡∏µ)</label>
                <input type="color" id="bgColor" value="#333333">
            </div>

        </div>
    </div>

    <script>
        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö Instance ‡∏Ç‡∏≠‡∏á Flipbook
        let pageFlip = null;
        const mainContainer = document.getElementById('main-container');
        const bookWrapper = document.getElementById('book-wrapper');
        const loading = document.getElementById('loading');

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå
        document.addEventListener('DOMContentLoaded', () => {
            // ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡πâ‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏™‡πà‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠
            loading.style.display = 'block';
            loading.innerText = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠';
        });

        // ---------------------------------------------
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Flipbook
        // ---------------------------------------------
        function createBook(images) {
            // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏¥‡πâ‡∏á (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
            bookWrapper.innerHTML = '<div class="flip-book" id="myBook"></div>';
            const bookElement = document.getElementById('myBook');

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤ HTML ‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
            images.forEach((imgSrc) => {
                const pageDiv = document.createElement('div');
                pageDiv.classList.add('page');
                pageDiv.innerHTML = `<img src="${imgSrc}" draggable="false" />`;
                bookElement.appendChild(pageDiv);
            });

            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Flipbook (‡∏Ç‡∏ô‡∏≤‡∏î, ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏á‡∏≤, etc.)
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏ï‡∏≤‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ (Responsive)
            const width = window.innerWidth > 600 ? 400 : 300;
            const height = window.innerWidth > 600 ? 600 : 450;

            pageFlip = new St.PageFlip(bookElement, {
                width: width, 
                height: height,
                size: "fixed",
                minWidth: 315,
                minHeight: 420,
                maxWidth: 1000,
                maxHeight: 1350,
                maxShadowOpacity: 0.5, // ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏°‡πÄ‡∏á‡∏≤
                showCover: true,
                mobileScrollSupport: false 
            });

            // ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏Ç‡πâ‡∏≤ Flipbook
            pageFlip.loadFromHTML(document.querySelectorAll('.page'));
            
            bookElement.style.display = 'block';
            loading.style.display = 'none';
        }

        // ---------------------------------------------
        // Event Listeners (‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ)
        // ---------------------------------------------

        // 1. ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ (Upload Pages)
        document.getElementById('bookUpload').addEventListener('change', function(e) {
            const files = e.target.files;
            if (files.length === 0) return;

            loading.style.display = 'block';
            loading.innerText = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...';
            
            const imageUrls = [];
            let filesLoaded = 0;

            // ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô URL
            for (let i = 0; i < files.length; i++) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    imageUrls[i] = event.target.result; // ‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö index
                    filesLoaded++;
                    // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏π‡∏õ ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠
                    if (filesLoaded === files.length) {
                        createBook(imageUrls);
                    }
                }
                reader.readAsDataURL(files[i]);
            }
        });

        // 2. ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á (Upload BG)
        document.getElementById('bgUpload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    mainContainer.style.backgroundImage = `url(${event.target.result})`;
                }
                reader.readAsDataURL(file);
            }
        });

        // 3. ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á (Color Picker)
        document.getElementById('bgColor').addEventListener('input', function(e) {
            // ‡∏•‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏≠‡∏≠‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏™‡∏µ
            mainContainer.style.backgroundImage = 'none';
            mainContainer.style.backgroundColor = e.target.value;
        });

    </script>
</body>
</html>